<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Run enrichment analysis and compute SNP-level priors using TORUS — run_torus • mapgen</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Run enrichment analysis and compute SNP-level priors using TORUS — run_torus"><meta property="og:description" content="Perform enrichment analysis using TORUS and then
compute SNP-level priors using the enrichment estimates."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">mapgen</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.5.10</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Tutorials
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/data_preparation_tutorial.html">Data preparation</a>
    </li>
    <li>
      <a href="../articles/enrichment_tutorial.html">Enrichment analysis</a>
    </li>
    <li>
      <a href="../articles/finemapping_tutorial.html">Functional fine-mapping</a>
    </li>
    <li>
      <a href="../articles/finemapping_ukbb_ld_diagnosis.html">Fine-mapping and LD diagnosis with UK Biobank reference LD matrices</a>
    </li>
    <li>
      <a href="../articles/gene_mapping_tutorial.html">Gene mapping</a>
    </li>
    <li>
      <a href="../articles/partition_pip_tutorial.html">PIP partitioning by annotation categories</a>
    </li>
    <li>
      <a href="../articles/track_plot_tutorial.html">Making track plots</a>
    </li>
  </ul></li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/xinhe-lab/mapgen/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Run enrichment analysis and compute SNP-level priors using TORUS</h1>
    <small class="dont-index">Source: <a href="https://github.com/xinhe-lab/mapgen/blob/HEAD/R/torus.R" class="external-link"><code>R/torus.R</code></a></small>
    <div class="hidden name"><code>run_torus.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Perform enrichment analysis using TORUS and then
compute SNP-level priors using the enrichment estimates.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">run_torus</span><span class="op">(</span></span>
<span>  <span class="va">torus_annot_file</span>,</span>
<span>  <span class="va">torus_zscore_file</span>,</span>
<span>  option <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"est"</span>, <span class="st">"est-prior"</span>, <span class="st">"fdr"</span><span class="op">)</span>,</span>
<span>  torus_path <span class="op">=</span> <span class="st">"torus"</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>torus_annot_file</dt>
<dd><p>SNP annotation file prepared by
the <code>prepare_torus_input_files</code> function.
The SNP annotation file contains SNP-level genomic annotations used by
TORUS analysis. The annotation file uses a header to specify the number
and the nature (categorical or continuous) of the annotations.
The first column with the header "SNP" represents the SNP name.
The following columns represent specific annotations.
For categorical/discrete annotations, the header should have a suffix "_d";
whereas for continuous annotations, the header should ends with "_c".</p></dd>


<dt>torus_zscore_file</dt>
<dd><p>Summary statistics from single SNP association
analysis, prepared by
the <code>prepare_torus_input_files</code> function.
Should be compressed in gzip format.</p></dd>


<dt>option</dt>
<dd><p>TORUS options:
“est”, obtain estimates of enrichment parameters and their confidence intervals;
“est-prior”, perform enrichment analysis and
compute SNP-level priors using
the estimated enrichment estimates for each locus;
or “fdr”, perform Bayesian FDR control, and output the result.</p></dd>


<dt>torus_path</dt>
<dd><p>Path to <code>torus</code> executable.</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p>A list of enrichment results, SNP-level prior probabilities,
and/or FDR result.
Enrichment result contains the point estimate (MLE) of the log odds ratio,
as well as 95% confidence interval for the corresponding point estimate.</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span><span class="co"># Get enrichment estimates and confidence intervals</span></span></span>
<span class="r-in"><span><span class="va">torus.result</span> <span class="op">&lt;-</span> <span class="fu">run_torus</span><span class="op">(</span><span class="st">"torus_annotations.txt.gz"</span>,</span></span>
<span class="r-in"><span>                          <span class="st">"torus_zscore.txt.gz"</span>,</span></span>
<span class="r-in"><span>                          option <span class="op">=</span> <span class="st">"est"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Get enrichment estimates and compute SNP-level priors</span></span></span>
<span class="r-in"><span><span class="va">torus.result</span> <span class="op">&lt;-</span> <span class="fu">run_torus</span><span class="op">(</span><span class="st">"torus_annotations.txt.gz"</span>,</span></span>
<span class="r-in"><span>                          <span class="st">"torus_zscore.txt.gz"</span>,</span></span>
<span class="r-in"><span>                          option <span class="op">=</span> <span class="st">"est-prior"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># Bayesian FDR control</span></span></span>
<span class="r-in"><span><span class="va">torus.result</span> <span class="op">&lt;-</span> <span class="fu">run_torus</span><span class="op">(</span><span class="st">"torus_annotations.txt.gz"</span>,</span></span>
<span class="r-in"><span>                          <span class="st">"torus_zscore.txt.gz"</span>,</span></span>
<span class="r-in"><span>                          option <span class="op">=</span> <span class="st">"fdr"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Kaixuan Luo, Alan Selewa, Xin He.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer></div>

  


  

  </body></html>

